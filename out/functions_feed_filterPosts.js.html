<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: functions/feed/filterPosts.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: functions/feed/filterPosts.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { postCard } from "../displayTemplates/postCard.js";
import { removePost } from "../../api/calls/feed/delete.js";
import { userFeedback } from "../userMessages/feed/feedbackTemplate.js";
import { displayPosts } from "./displayPosts.js";

/**
 * This function takes an array of posts as the parameter and filters out any posts that don't have tags. It also filters out tags that are empty arrays as some tags return as true despite not having any values.
 * @param {array} posts Array containing all the posts from the database
 */
export function filterPosts(posts) {
  const getPostsSection = document.querySelector(".postsSection");
  const getFilterBtn = document.querySelector("#filterByTag");
  const getAllPostsBtn = document.querySelector("#allPosts");

  getFilterBtn.addEventListener("click", () => {
    const filteredPosts = new Set();
    getPostsSection.innerHTML = "";
    posts.filter((post) => {
      for (let i = 0; i &lt; post.tags.length; i++) {
        const postContent = `${post.title}${post.body}`;
        const spreadArray = [...post.tags[i]];
        if (spreadArray.length > 2) {
          if (!filteredPosts.has(postContent)) {
            filteredPosts.add(postContent);

            getPostsSection.append(
              postCard(
                post.media,
                post.title,
                post.author.name,
                post.created,
                post.body,
                post.id,
                post.tags
              )
            );
          }
        }
        const getDeleteBtn = document.getElementById(`${post.id}`);
        if (getDeleteBtn) {
          getDeleteBtn.addEventListener("click", () => {
            removePost(post.id);
            userFeedback(`Post deleted!`);
          });
        }
      }
    });
  });

  getAllPostsBtn.addEventListener("click", () => {
    displayPosts();
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#backBtn">backBtn</a></li><li><a href="global.html#changeAvatar">changeAvatar</a></li><li><a href="global.html#confirmDelete">confirmDelete</a></li><li><a href="global.html#createPost">createPost</a></li><li><a href="global.html#displayChangeAvatar">displayChangeAvatar</a></li><li><a href="global.html#displayPost">displayPost</a></li><li><a href="global.html#displayProfile">displayProfile</a></li><li><a href="global.html#displayUserPosts">displayUserPosts</a></li><li><a href="global.html#errorMsg">errorMsg</a></li><li><a href="global.html#filterPosts">filterPosts</a></li><li><a href="global.html#getAvatarData">getAvatarData</a></li><li><a href="global.html#getLoginData">getLoginData</a></li><li><a href="global.html#getNewPostData">getNewPostData</a></li><li><a href="global.html#getPost">getPost</a></li><li><a href="global.html#getPosts">getPosts</a></li><li><a href="global.html#getProfile">getProfile</a></li><li><a href="global.html#getRegisterData">getRegisterData</a></li><li><a href="global.html#getUserPosts">getUserPosts</a></li><li><a href="global.html#loadStorage">loadStorage</a></li><li><a href="global.html#loader">loader</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#loginRegSuccess">loginRegSuccess</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#postCard">postCard</a></li><li><a href="global.html#register">register</a></li><li><a href="global.html#removePost">removePost</a></li><li><a href="global.html#removeStorage">removeStorage</a></li><li><a href="global.html#saveStorage">saveStorage</a></li><li><a href="global.html#searchPosts">searchPosts</a></li><li><a href="global.html#setProfileLink">setProfileLink</a></li><li><a href="global.html#setUserPic">setUserPic</a></li><li><a href="global.html#socialBattery">socialBattery</a></li><li><a href="global.html#updatePost">updatePost</a></li><li><a href="global.html#updatePostForm">updatePostForm</a></li><li><a href="global.html#userFeedback">userFeedback</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Feb 26 2024 17:46:23 GMT+0100 (sentraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
