<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: api/calls/feed/read.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: api/calls/feed/read.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { API_BASE, API_POSTS } from "../../constants.js";
import { loadStorage } from "../../../functions/storage/localStorage.js";
import { loader } from "../../../functions/loader.js";
import { saveStorage } from "../../../functions/storage/localStorage.js";

/**
 * This function makes an API call with an access token taken from localStorage to fetch all posts from the database. It saves the posts to localStorage and returns the posts in .json format.
 * @returns .json result
 * @example
 * ```
 * async function getPosts() {
 *   const API_URL = "https://apiurl.com";
 *   const token = "s2jh5wy9fas8a9y2";
 *   try {
 *     const response = await fetch(API_URL, {
 *        "Content-Type": "application/json",
 *       Authorization: `Bearer ${token}`,
 *     });
 *     const posts = await response.json();
 *     if(response.ok) {
 *       saveStorage("posts", posts);
 *       return posts;
 *     }
 *   } catch(error) {
 *     console.error(error);
 *   }
 * }
 * ```
 */
export async function getPosts() {
  loader();
  const getPostsAPI = API_BASE + API_POSTS + `?_author=true`;

  const token = loadStorage("token");
  try {
    const response = await fetch(getPostsAPI, {
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${token}`,
      },
    });
    const posts = await response.json();
    if (response.ok) {
      const getLoader = document.querySelector(".loader");
      if (getLoader) {
        getLoader.classList.remove("loader");
      }
      saveStorage("posts", posts);
      console.log(posts);
      return posts;
    }
  } catch (error) {
    console.error(error);
  }
}

/**
 * This function takes a number as the parameter and sends an API call with an access token taken from localStorage to fetch a specific post from the database. It removes a loader in the case of a positive response and returns the post in .json format.
 * @param {number} id ID of post
 * @returns .json format response from API call
 * @example
 * ```
 * async function getPost(id) {
 *   const API_URL = "https://apiurl.com";
 *   const token = "s2jh5wy9fas8a9y2";
 *   const singlePost_API = API_URL + `/` + id;
 *   try {
 *     const response = await fetch(singlePost_API, {
 *        "Content-Type": "application/json",
 *       Authorization: `Bearer ${token}`,
 *     });
 *     const post = await response.json();
 *     if(response.ok) {
 *       return post;
 *     }
 *   } catch(error) {
 *     console.error(error);
 *   }
 * }
 * ```
 */
export async function getPost(id) {
  loader();
  const getPostsAPI = API_BASE + API_POSTS + `/` + id + `?_author=true`;
  const token = loadStorage("token");
  try {
    let response = await fetch(getPostsAPI, {
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${token}`,
      },
    });
    const post = await response.json();
    if (response.ok) {
      const getLoader = document.querySelector(".loader");
      if (getLoader) {
        getLoader.classList.remove("loader");
      }
      return post;
    }
  } catch (error) {
    console.error(error);
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#backBtn">backBtn</a></li><li><a href="global.html#changeAvatar">changeAvatar</a></li><li><a href="global.html#confirmDelete">confirmDelete</a></li><li><a href="global.html#createPost">createPost</a></li><li><a href="global.html#displayChangeAvatar">displayChangeAvatar</a></li><li><a href="global.html#displayPost">displayPost</a></li><li><a href="global.html#displayProfile">displayProfile</a></li><li><a href="global.html#displayUserPosts">displayUserPosts</a></li><li><a href="global.html#errorMsg">errorMsg</a></li><li><a href="global.html#filterPosts">filterPosts</a></li><li><a href="global.html#getAvatarData">getAvatarData</a></li><li><a href="global.html#getLoginData">getLoginData</a></li><li><a href="global.html#getNewPostData">getNewPostData</a></li><li><a href="global.html#getPost">getPost</a></li><li><a href="global.html#getPosts">getPosts</a></li><li><a href="global.html#getProfile">getProfile</a></li><li><a href="global.html#getRegisterData">getRegisterData</a></li><li><a href="global.html#getUserPosts">getUserPosts</a></li><li><a href="global.html#loadStorage">loadStorage</a></li><li><a href="global.html#loader">loader</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#loginRegSuccess">loginRegSuccess</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#postCard">postCard</a></li><li><a href="global.html#register">register</a></li><li><a href="global.html#removePost">removePost</a></li><li><a href="global.html#removeStorage">removeStorage</a></li><li><a href="global.html#saveStorage">saveStorage</a></li><li><a href="global.html#searchPosts">searchPosts</a></li><li><a href="global.html#setProfileLink">setProfileLink</a></li><li><a href="global.html#setUserPic">setUserPic</a></li><li><a href="global.html#socialBattery">socialBattery</a></li><li><a href="global.html#updatePost">updatePost</a></li><li><a href="global.html#updatePostForm">updatePostForm</a></li><li><a href="global.html#userFeedback">userFeedback</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Mon Feb 26 2024 17:46:23 GMT+0100 (sentraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
